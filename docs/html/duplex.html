<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>vitamin-v: Duplex Mode</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">vitamin-v
   &#160;<span id="projectnumber">0.0.0</span>
   </div>
   <div id="projectbrief">the vi-tracker</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Duplex Mode </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Finally, it is easy to use <a class="el" href="class_rt_audio.html" title="Realtime audio i/o C++ classes. ">RtAudio</a> for simultaneous audio input/output, or duplex operation. In this example, we simply pass the input data back to the output.</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="_rt_audio_8h.html">RtAudio.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;cstdlib&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;cstring&gt;</span></div><div class="line"></div><div class="line"><span class="comment">// Pass-through function.</span></div><div class="line"><span class="keywordtype">int</span> inout( <span class="keywordtype">void</span> *outputBuffer, <span class="keywordtype">void</span> *inputBuffer, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nBufferFrames,</div><div class="line">           <span class="keywordtype">double</span> streamTime, <a class="code" href="_rt_audio_8h.html#a80e306d363583da3b0a1b65d9b57c806">RtAudioStreamStatus</a> status, <span class="keywordtype">void</span> *data )</div><div class="line">{</div><div class="line">  <span class="comment">// Since the number of input and output channels is equal, we can do</span></div><div class="line">  <span class="comment">// a simple buffer copy operation here.</span></div><div class="line">  <span class="keywordflow">if</span> ( status ) std::cout &lt;&lt; <span class="stringliteral">&quot;Stream over/underflow detected.&quot;</span> &lt;&lt; std::endl;</div><div class="line"></div><div class="line">  <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> *bytes = (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> *) data;</div><div class="line">  memcpy( outputBuffer, inputBuffer, *bytes );</div><div class="line">  <span class="keywordflow">return</span> 0;</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keywordtype">int</span> main()</div><div class="line">{</div><div class="line"> <a class="code" href="class_rt_audio.html">RtAudio</a> adac;</div><div class="line">  <span class="keywordflow">if</span> ( adac.<a class="code" href="class_rt_audio.html#a747ce2d73803641bbb66d6e78092aa1a">getDeviceCount</a>() &lt; 1 ) {</div><div class="line">    std::cout &lt;&lt; <span class="stringliteral">&quot;\nNo audio devices found!\n&quot;</span>;</div><div class="line">    exit( 0 );</div><div class="line">  }</div><div class="line"></div><div class="line">  <span class="comment">// Set the same number of channels for both input and output.</span></div><div class="line">  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> bufferBytes, bufferFrames = 512;</div><div class="line">  <a class="code" href="struct_rt_audio_1_1_stream_parameters.html">RtAudio::StreamParameters</a> iParams, oParams;</div><div class="line">  iParams.<a class="code" href="struct_rt_audio_1_1_stream_parameters.html#ab3c72bcf3ef12149ae9a4fb597cc5489">deviceId</a> = 0; <span class="comment">// first available device</span></div><div class="line">  iParams.<a class="code" href="struct_rt_audio_1_1_stream_parameters.html#a88a10091b6e284e21235cc6f25332ebd">nChannels</a> = 2;</div><div class="line">  oParams.<a class="code" href="struct_rt_audio_1_1_stream_parameters.html#ab3c72bcf3ef12149ae9a4fb597cc5489">deviceId</a> = 0; <span class="comment">// first available device</span></div><div class="line">  oParams.<a class="code" href="struct_rt_audio_1_1_stream_parameters.html#a88a10091b6e284e21235cc6f25332ebd">nChannels</a> = 2;</div><div class="line"></div><div class="line">  <span class="keywordflow">try</span> {</div><div class="line">    adac.<a class="code" href="class_rt_audio.html#a6907539d2527775df778ebce32ef1e3b">openStream</a>( &amp;oParams, &amp;iParams, RTAUDIO_SINT32, 44100, &amp;bufferFrames, &amp;inout, (<span class="keywordtype">void</span> *)&amp;bufferBytes );</div><div class="line">  }</div><div class="line">  <span class="keywordflow">catch</span> ( <a class="code" href="class_rt_audio_error.html">RtAudioError</a>&amp; e ) {</div><div class="line">    e.<a class="code" href="class_rt_audio_error.html#a0124bb90075cf3201865a0ea9b43a826">printMessage</a>();</div><div class="line">    exit( 0 );</div><div class="line">  }</div><div class="line"></div><div class="line">  bufferBytes = bufferFrames * 2 * 4;</div><div class="line"></div><div class="line">  <span class="keywordflow">try</span> {</div><div class="line">    adac.<a class="code" href="class_rt_audio.html#aec017a89629ccef66a90b60be22a2f80">startStream</a>();</div><div class="line"></div><div class="line">    <span class="keywordtype">char</span> input;</div><div class="line">    std::cout &lt;&lt; <span class="stringliteral">&quot;\nRunning ... press &lt;enter&gt; to quit.\n&quot;</span>;</div><div class="line">    std::cin.get(input);</div><div class="line"></div><div class="line">    <span class="comment">// Stop the stream.</span></div><div class="line">    adac.<a class="code" href="class_rt_audio.html#af4c241ff86936ecc8108f0d9dfe3efdd">stopStream</a>();</div><div class="line">  }</div><div class="line">  <span class="keywordflow">catch</span> ( <a class="code" href="class_rt_audio_error.html">RtAudioError</a>&amp; e ) {</div><div class="line">    e.<a class="code" href="class_rt_audio_error.html#a0124bb90075cf3201865a0ea9b43a826">printMessage</a>();</div><div class="line">    <span class="keywordflow">goto</span> cleanup;</div><div class="line">  }</div><div class="line"></div><div class="line"> cleanup:</div><div class="line">  <span class="keywordflow">if</span> ( adac.<a class="code" href="class_rt_audio.html#a3863e45ff81dbe97176de0ee7545917f">isStreamOpen</a>() ) adac.<a class="code" href="class_rt_audio.html#a90d599002ad32cf250a4cb866f2cc93a">closeStream</a>();</div><div class="line"></div><div class="line">  <span class="keywordflow">return</span> 0;</div><div class="line">}</div></div><!-- fragment --><p>In this example, audio recorded by the stream input will be played out during the next round of audio processing.</p>
<p><a class="el" href="class_note.html">Note</a> that a duplex stream can make use of two different devices (except when using the Linux Jack and Windows ASIO APIs). However, this may cause timing problems due to possible device clock variations, unless a common external "sync" is provided. </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
